<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>Game Controller</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #222;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden; /* Prevent scrolling */
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            height: 100%;
            width: 100%;
            max-width: 600px;
            max-height: 620px;
            transform: scale(var(--scale-factor));
            transform-origin: top left;
        }
        @media (max-width: 600px), (max-height: 620px) {
            :root {
                --scale-factor: calc(min(100vw / 600, 100vh / 620));
            }
        }
        .buttons {
            position: absolute;
            top: 5%;
            left: 50%;
            transform: translate(-50%, 0);
            width: 300px;
            display: flex;
            justify-content: space-between;
            gap: 20px;
            border-radius: 10px;
        }
        .thumbstick {
            position: absolute;
            width: 150px;
            height: 150px;
            background-color: #444;
            border-radius: 50%;
            touch-action: none;
        }
        .thumbstick-inner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background-color: #888;
            border-radius: 50%;
        }
        .left-thumbstick {
            left: 20%;
            top: 65%;
            transform: translate(-50%, -50%);
        }
        .right-thumbstick {
            right: 20%;
            top: 65%;
            transform: translate(50%, -50%);
        }
        .thumbstick-button {
            position: absolute;
            bottom: 0;
            width: 60px; /* 20% larger */
            height: 36px; /* 20% larger */
            background-color: #555;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 16px;
            text-align: center;
            line-height: 36px; /* match height */
        }
        .left-thumbstick .thumbstick-button {
            left: calc(70% + 80px); 
            transform: translateX(-10%);
        }
        .right-thumbstick .thumbstick-button {
            right: calc(70% + 80px); 
            transform: translateX(10%);
        }
        .dpad {
            position: absolute;
            left: calc(10% - 100px); /* Move left by another 50px */
            top: 40%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
        }
        .dpad button {
            width: 100%;
            height: 100%;
            background-color: #555;
            border: none;
            border-radius: 5px;
            color: #fff;
            font-size: 18px;
        }
        .dpad button:nth-child(1) {
            grid-column: 2;
            grid-row: 1;
        }
        .dpad button:nth-child(2) {
            grid-column: 1;
            grid-row: 2;
        }
        .dpad button:nth-child(3) {
            grid-column: 3;
            grid-row: 2;
        }
        .dpad button:nth-child(4) {
            grid-column: 2;
            grid-row: 3;
        }
        .dpad button:nth-child(5) {
            grid-column: 2;
            grid-row: 2;
            visibility: hidden;
        }
        .abxy {
            position: absolute;
            right: calc(10% - 100px); /* Move right by another 50px */
            top: 40%;
            transform: translate(50%, -50%);
            width: 180px;
            height: 180px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
        }
        .abxy button {
            width: 100%;
            height: 100%;
            background-color: #555;
            border: none;
            border-radius: 50%;
            color: #fff;
            font-size: 18px;
        }
        .abxy button:nth-child(1) {
            grid-column: 2;
            grid-row: 3;
        }
        .abxy button:nth-child(2) {
            grid-column: 3;
            grid-row: 2;
        }
        .abxy button:nth-child(3) {
            grid-column: 1;
            grid-row: 2;
        }
        .abxy button:nth-child(4) {
            grid-column: 2;
            grid-row: 1;
        }
        .abxy button:nth-child(5) {
            grid-column: 2;
            grid-row: 2;
            visibility: hidden;
        }
        .start-select {
            position: absolute;
            top: 45%; /* Move up a little bit */
            transform: translateY(-50%);
            display: flex;
            justify-content: space-between;
            width: 200px;
        }
        .start-select button {
            width: 80px;
            height: 40px;
            background-color: #555;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 16px;
        }
        .start-button {
            right: 20%;
        }
        .select-button {
            left: 20%;
        }
        .shoulder-buttons {
            position: absolute;
            top: calc(10% + 50px); /* Move down by 50px */
            width: 80%;
            display: flex;
            justify-content: space-between;
            padding: 0 20%; 
        }
        .shoulder-buttons .left-buttons,
        .shoulder-buttons .right-buttons {
            display: flex;
            gap: 10px;
        }
        .shoulder-buttons button {
            width: 90px; /* 50% wider */
            height: 48px; /* 20% taller */
            background-color: #555;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="buttons">
            <!-- Add button elements here -->
        </div>
        <div class="shoulder-buttons">
            <div class="left-buttons">
                <button>L1</button>
                <button>L2</button>
            </div>
            <div class="right-buttons">
                <button>R1</button>
                <button>R2</button>
            </div>
        </div>
        <div class="thumbstick left-thumbstick" id="left-thumbstick">
            <div class="thumbstick-inner" id="left-thumbstick-inner"></div>
            <button class="thumbstick-button">L3</button>
        </div>
        <div class="thumbstick right-thumbstick" id="right-thumbstick">
            <div class="thumbstick-inner" id="right-thumbstick-inner"></div>
            <button class="thumbstick-button">R3</button>
        </div>
        <div class="dpad">
            <button>Up</button>
            <button>Left</button>
            <button>Right</button>
            <button>Down</button>
            <button></button>
        </div>
        <div class="abxy">
            <button>A</button>
            <button>B</button>
            <button>X</button>
            <button>Y</button>
            <button></button>
        </div>
        <div class="start-select">
            <button class="select-button">Select</button>
            <button class="start-button">Start</button>
        </div>
    </div>
    <script>
        const createThumbstick = (thumbstickId, thumbstickInnerId) => {
            const thumbstick = document.getElementById(thumbstickId);
            const thumbstickInner = document.getElementById(thumbstickInnerId);
            let activeTouchId = null;
            let startX, startY;

            const start = (x, y, id) => {
                activeTouchId = id;
                startX = x;
                startY = y;
            };

            const move = (x, y) => {
                if (activeTouchId === null) return;
                const deltaX = x - startX;
                const deltaY = y - startY;
                const distance = Math.min(Math.sqrt(deltaX * deltaX + deltaY * deltaY), 65);
                const angle = Math.atan2(deltaY, deltaX);
                const moveX = distance * Math.cos(angle);
                const moveY = distance * Math.sin(angle);
                thumbstickInner.style.transform = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
            };

            const end = (id) => {
                if (activeTouchId !== id) return;
                activeTouchId = null;
                thumbstickInner.style.transform = 'translate(-50%, -50%)';
            };

            thumbstick.addEventListener('touchstart', (e) => {
                for (let touch of e.changedTouches) {
                    if (activeTouchId === null) {
                        start(touch.clientX, touch.clientY, touch.identifier);
                    }
                }
            });

            thumbstick.addEventListener('touchmove', (e) => {
                for (let touch of e.changedTouches) {
                    if (touch.identifier === activeTouchId) {
                        move(touch.clientX, touch.clientY);
                    }
                }
            });

            thumbstick.addEventListener('touchend', (e) => {
                for (let touch of e.changedTouches) {
                    end(touch.identifier);
                }
            });

            thumbstick.addEventListener('mousedown', (e) => {
                start(e.clientX, e.clientY, 'mouse');
            });

            document.addEventListener('mousemove', (e) => {
                if (activeTouchId === 'mouse') {
                    move(e.clientX, e.clientY);
                }
            });

            document.addEventListener('mouseup', () => {
                end('mouse');
            });
        };

        createThumbstick('left-thumbstick', 'left-thumbstick-inner');
        createThumbstick('right-thumbstick', 'right-thumbstick-inner');
    </script>
</body>
</html>